### 天眼中搜索ip

["192.168.0.0" TO "192.168.255.255"]

### 日志检索中

日志检索系统支持 AND OR NOT 三种运算符（运算符要大写）
dip:10.16.16.46 AND client_os:"Windows7 or 8"
dport:"443" OR dport:"8080"
dport:"80" NOT host:"www.example.com" 
使用问号（?）表示单个字符的通配符搜索，使用星号（*）表示多个字符的通配符搜索
5.有一条告警同时出现了两次
①. 可能是同一条告警流量触发2条告警规则
②. 同一条告警流量可能会有多个ip，因为外网ip到内网ip会进行ip转换
③. xff字段进行提取ip的时候，可能会提取多次

### 6.搜索源ip和目标ip，命令 sip="" dip=""

### 7.天眼那块能看到正常数据

【威胁告警】-【告警列表】中的详情

### 10.威胁情报，天眼中也有，天眼会产生威胁情报的告警，出现这样情况，你要怎么判断

看具体的请求体响应体具体分析是否是误报,在客户允许的情况下进行复现验证

### 11.告警产生误报的原因有什么

①防火墙、邮件网关有发起黑域名解析的行为可能是误
②威胁情报可能失效了，这时候需要更新威胁情报

### 12.天眼有没有主动扫描的功能

扫描截取的流量包或一些文件，威胁感知，策略配置-威胁检测-弱口令

### 14.天眼中只有http的告警，但没有https的告警，为什么

（不一定对）https流量经过ssl加密，可能因为天眼中没有配置ssl证书或者ssl密钥

### 15.天眼会对正常的数据包存储吗

不会，也不会对命中白名单的数据进行存储

### 16.天眼平台的规则告警主要依赖什么

安全规则和策略的配置（不确定）安全监控系统，，攻击特征库，漏洞扫描和漏洞管理，安全事件响应和处理

### 17.天眼平台危险等级有哪些？

低危 中危 高危 危急

### 18.天眼分析平台中，发件人是什么？

### 19.天眼怎么标记攻击ip







#### CS流量特征？



- #### 心跳包特征 

	a) 间隔一定时间，均有通信，且流级上的上下行数据长度固定； 

- 域名/IP特征 

	a) 未走CDN、域前置的，域名及IP暴露

	b) 走CDN、域前置的，真实IP会被隐藏； 

- 指令特征 

	a) 下发指令时，通过心跳包接收指令，这时，server端返回的包更长，甚至包含要加载的dll模块数据。 

	b) 指令执行完后，client端通过POST请求发送执行的结果数据，body部分通过加密和base64编码。 

	c) 不同指令，执行的时间间隔不一样，可以通过POST请求和GET请求的间隔进行判断。 

- 数据特征 

	a) 在请求的返回包中，通信数据均隐藏在jqeury*.js中。



1、被控端发送心跳包

2.服务端收到并记录被控端主机信息

如果心跳包不存在了，说明主机下线了，存在说明处于被控状态

3.再次发送心跳包询问是否有指令

服务端会再次向被控端发送心跳包以获取任务指令，例如执行什么命令

4.发送需要进行的操作指令

服务端会将需要执行的操作指令发送给被控端

5将命令加密后发送给被控端

在发送指令前，Server段会对命令进行加密处理，以确保指令的安全性

6.被控端接收指令

接收并解密指令，然后执行相应的操作，并将结果返回给服务端

判断cs是否魔改

要判断一个CS是否被魔改，我们可以通过捕获木马的心跳包来进行判断，这些心跳包通常由四个数字或字母组成。例如，使用Wireshark等网络抓包工具，可以捕获到后门的HTTP数据包“GET /4Ekx HTTP/1.1”，其中的“4Ekx”就是心跳包。我们可以将“4Ekx”加入checksum8解密源码中进行解密，得到的结果为92，这代表着未被魔改的CS上线了一个x86位的木马。同时，反编译CS的源代码也可以得知，92L对应于x86位的木马，而93L对应于x64位的后门。如果CS被魔改，其木马的GET请求将会被加密，而非明文传输，

### 特征

#### 下发指令

攻击者执行命令下发指令时，你会看到木马访问攻击者C2服务器上的submit.php页面，并且在访问请求中带有一个id参数。这就是CS下发指令的特征之一

### UA头特征（老版）

CS 4.0版本的UA头是固定的，可以作为特征。但是CS 4.5及以上版本中，每个木马都会随机生成一个UA头，避免被蓝队检测到

### HTTPS的JA3和JA3S的值

在 HTTPS 协议的 Client Hello 和 Server Hello 阶段，都包含了 JA3S 值传输过程过程中会有 ja3，这个值在系统上是固定的，win10是一种的 但win11是另一种 他们取决于操作系统（假如你的系统是 win11，则其对应的 JA3S 值为 1111；如果是 win10，则对应的 JA3S 值为 2222）




#### Windows应急响应常用命令？

查看用户账号和组        lusrmgr

打开lusrmgr.msc，查看是否有新增/可疑的账号

敏感事件id:
4624 登录成功
4625 登录失败
4634 注销成功
4647 用户启动的注销
4672 使用超级用户/管理员用户进行登录
4720 创建用户
4697 7045 PsExec

查看自启动项                    msconfig

查看进程服务                    taskmgr

wmic process where name='进程名' list full 4      查看进程详细信息

taskkill /T /F /PID     强制关闭进程

wmic process | finderstr “xxxx.exe”    获取进程的全路径  

查看计划任务                    schtasks

查看用户会话                    query user

查看端口和网络连接          netstat -ano

查看本地共享                    net share

查看注册表                       regedit

查看日志                           eventvwr

### Weblogic管理端未授权的两个页面存在任意上传jsp文件漏洞

### Tomcat  任意文件写入  任意文件读取+文件包含  弱口令+war后门文件部署（弱口令tomcat tomcat）

### 44.DNS外带是否成功

查看DNSlog记录
天眼的日志分析->域名解析 搜sip

### 常见端口：

- MySQL：3306
- Oracle：1521
- SQL Server：1433
- DB2：5000
- Redis：6379 （未授权访问漏洞<Redis默认情况是空密码连接>,写入公钥远程连接，定时任务反弹shell）
- （redis是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API）
- MongoDB：27017
nc -lvp 50050  #监听50050端口

### Log4J2的流量特征？
Log4j是一个常用的Java日志框架，而与Log4j相关的攻击主要是基于Log4j 2.x 中的漏洞，攻击者通过该漏洞可以在目标服务器上执行任意代码，
因此对应的流量特征主要是以下几个方面：

1. DNS解析异常：攻击者可能会通过Log4j漏洞利用DNS查询，以便向恶意服务器发送请求。因此，在DNS查询中可能会出现异常解析请求，
  例如请求的域名为一串随机字符，或者请求的域名包含非常规字符等。
2. HTTP/HTTPS请求异常：攻击者可能会利用Log4j漏洞向恶意服务器发送HTTP/HTTPS请求，并在请求中注入恶意代码。因此，
  在网络流量中可能会出现异常的HTTP/HTTPS请求，例如请求的URL包含异常字符或者非常规路径，请求的响应状态码不正常（如404、500等），或者请求的响应内容包含异常字符等。
3. 反向Shell连接：攻击者可能会利用Log4j漏洞建立反向Shell连接，以便在目标服务器上执行命令并获取敏感信息。因此，
  在网络流量中可能会出现异常的TCP连接，例如目标服务器向外部恶意服务器建立连接，或者恶意服务器向目标服务器建立连接等。
4. 异常的日志记录：攻击者利用Log4j漏洞可能会在目标服务器上记录异常的日志信息，例如日志信息中包含异常的字符或者命令注入等，
  或者日志信息的格式和内容与正常的日志信息不匹配等。如果发现以上异常流量特征，应该考虑系统是否存在Log4j漏洞，并及时采取相应的应急响应措施。

### Log4j2漏洞原理：

因为Log4j2默认支持解析ldap/rmi协议，然后JNDI注入

1、攻击则发送带有恶意Ldap内容的字符串，让服务通过log4j2打印

2、log4j2解析到ldap内容，会调用底层Java去执行Ldap的lookup操作。

3、Java底层请求Ldap服务器（恶意服务器），得到了Codebase地址，告诉客户端去该地址获取他需要的类。

4、Java请求Codebase服务器(恶意服务器)获取到对应的类（恶意类），并在本地加载和实例化（触发恶意代码）。
JDK版本低于JDK 8u191才可以实现



### 45.SQL注入的分类

可显注入
攻击者可以直接在当前界面内容中获取想要获得的内容。

报错注入
数据库查询返回结果并没有在页面中显示，但是应用程序将数据库报错信息打印到了页面中，所以攻击者可以构造数据库报错语句，从报错信息中获取想要获得的内容。

盲注
数据库查询结果无法从直观页面中获取，攻击者通过使用数据库逻辑或使数据库库执行延时等方法获取想要获得的内容。

时间盲注
常用函数 sleep ()
分割函数 substr、substring、left
分割函数编码后可不用引号，ascii () hex ()
一般时间盲注我们还需要使用条件判断函数
if（expre1，expre2，expre3）
当 expre1 为 true 时，返回 expre2，false 时，返回 expre3

布尔盲注
这种注入会出现在 注册、ip 头、留言板等等需要写入数据的地方，如用 sqlmap 会产生大量垃圾数据。尝试性插入、引号、双引号、转义符 \ 让语句不能正常执行，然后如果插入失败，更新失败，然后深入测试确定是否存在注入。

二次注入：
sql 语句的变量并不是直接传入的变量，而是通过其它的方式保存到了数据库，形成二次注入。没有单引号的 sql 语句中，进行 16 进制编码，这样就不会带有单引号。

宽字节注入：
字符注入的时候我们需要逃逸单引号，但是 php 提供了魔术引号开关 magic_quotes_gpc 和 addslashes ()，iconv () 函数作为防御，特点是自动给传入的参数如单引号，双引号，反斜杠，%00 前面加一个反斜杠，进行转义，避免单引号进行逃逸。单引号转义为 ‘ , mysql 会将 \ 编码为 %5c ，宽字节中两个字节代表一个汉字，所以把 % df 加上 %5c 就变成了一个汉字 “運”，从而绕过转义。如果数据库是 GBK 格式而非默认的 UTF-8 格式，则我们利用两个 url 编码是一个汉字的特点，组合一个汉字从而解决”\“问题，完成单引号的逃逸。

数字型注入
当我们访问页面时经常会出现 http:xxx.admin.com?id=1 这种形式的 url，这个时候我们输入 and 1=1 与 and 1=2, 进行判定看是否会出现 and 1=1 回显正常，and 1=2 回显不正常的情况。如果出现了我们一般就认为这里存在注入，并且是数字型注入。如果没有出现那么并不能排查这里没有注入，只是排除这里不存在数字型的注入。

字符型注入
url 后输入’ and 1=1 and ‘1’=’1，’ and 1=2 and ‘1’=’1。看是否会出现报错的现象。如果存在我们可以进一步的闭合我们的语句。

http 头部注入
user-agent: 判定用户使用的操作系统，以及使用的浏览器的版本。
cookie: 判定用户的身份，进行 session 跟踪可以存储在用户本地终端上的数据，简单理解为用户的一张身份辨别卡。
x-forwarded-for: 是用来识别通过 HTTP 代理或负载均衡方式连接到 Web 服务器的客户端最原始的 IP 地址的 HTTP 请求头字段。
client-ip: 数据库保存客户端 IP 的参数。
rerferer: 浏览器向 web 端表明自己从哪个连接而来。
host: 客户端指定自己想访问的 WEB 服务器的域名 / IP 地址和端口号。

### sqlmap os-shell 执行原理

对于my[sql数据库](https://so.csdn.net/so/search?q=sql数据库&spm=1001.2101.3001.7020)来说，--os-shell的本质就是写入两个php文件，其中的tmpugvzq.php可以让我们上传文件到网站路径下

后[sqlmap](https://so.csdn.net/so/search?q=sqlmap&spm=1001.2101.3001.7020)就会通过上面这个php上传一个用于命令执行的tmpbylqf.php到网站路径下，让我们命令执行，并将输出的内容返回sqlmap端。



### sqlmap注入https

因为目标站是https 我加了--force-ssl参数 指定为https，但是显示https 连接出错。

因为sqlmap没办法忽略https证书 所以有两个解决方法

1. 通过本地代理端口进行访问
2. 通过搭建web，访问代理文件进行注入

第一种简单又不涉及代码 直接burpsuite代理本地8080端口，然后sqlmap通过8080端口进行访问注入即可(当然其他本地映射charles也可以)

### sqlmap的ua头

默认情况下sqlmap的HTTP请求头中User-Agent值是：

sqlmap/1.0-dev-xxxxxxx (http://sqlmap.org)

可以使用--user-anget参数来修改，同时也可以使用--random-agnet参数来随机的从./txt/user-agents.txt中获取。

当--level参数设定为3或者3以上的时候，会尝试对User-Angent进行注入。


### shiro 550 721 有什么区别**

Apache Shiro反序列化漏洞：Shiro rememberMe（Shiro-550） Shiro Padding Oracle Attack(Shiro-721)
Shiro 550和721都是密码学中常用的加密算法标准，但它们使用的加密密钥长度和加密算法细节有所不同。下面是它们的简要区别：Shiro 550：使用56位密钥进行加密，是DES算法的一种变体。DES算法已经被认为是不安全的，因为它的密钥长度过短，易受到暴力破解攻击。因此，Shiro 550算法已经被淘汰，不再被推荐使用。Shiro 721：使用128位密钥进行加密，是AES算法的一种变体。AES算法是目前广泛使用的加密算法，具有高度的安全性和可靠性。Shiro 721是对AES算法的一个改进，增加了一些加密特性，使其更加适用于某些特定的应用场景。综上所述，Shiro 550已经不再被推荐使用，而Shiro 721是目前较为安全和可靠的加密算法之一。



### shiro550 反序列化漏洞

shiro反序列化主要就是对cookie进行的一系列操作, 也就是 选了 rememberme（记住秘密）
处理cookie流程：得到rememberMe的cookie值 --> Base64解码 --> AES解密 --> 反序列化

特征：rememberMe=deleteMe

### shiro721 反序列化漏洞

由于Apache Shiro cookie中通过 AES-128-CBC模式加密的rememberMe字段存在问题，用户可通过Padding  Oracle 加密生成的攻击代码来构造恶意的rememberMe字段，并重新请求网站，进行反序列化攻击，最终导致任意代码执行。

需要得到合法的cookie

流程：1.登录网站（勾选Remember），并从Cookie中获取合法的RememberMe。
2.使用RememberMe cookie作为Padding Oracle Attack的前缀。
3.加密 ysoserial 的序列化 payload，以通过Padding Oracle Attack制作恶意RememberMe。
4.重放恶意RememberMe cookie，以执行反序列化攻击。

### struts2漏洞 S2-001

漏洞原理

该漏洞因用户提交表单数据并且验证失败时，后端会将用户之前提交的参数值使用OGNL表达式**%{value}**进行解析，然后重新填充到对应的表单数据中。如注册或登录页面，提交失败后一般会默认返回之前提交的数据，由于后端使用%{value}对提交的数据执行了一次OGNL 表达式解析，所以可以直接构造 Payload进行命令执行。


### struts2识别

常规的办法有：

1. 通过页面回显的错误消息来判断，页面不回显错误消息时则无效。
2. 通过网页后缀来判断，[如.do](http://xn--bvs.do) .action，有可能不准。
3. 判断 /struts/webconsole.html 是否存在来进行判断，需要 devMode 为 true。



### Java 内存码

java agent 是 Java 程序。它可以通过 java.lang.instrument 包提供的 Java 标准接口进行代码插桩，从而在 Java 应用程序的[类加载](https://so.csdn.net/so/search?q=类加载&spm=1001.2101.3001.7020)和运行期间改变 Java 字节码。而java agent内存马就是利用这个特性产生。





### 怎么判断告警是误报？

” 比如说：攻击方尝试利用现成的「EXP&POC集成脚本工具」对资产目标进行检测扫描，安全设备检测到「攻击尝试行为」中的攻击特征就会产生告警。在通常情况下，可以把告警中的URL的“网页状态码”、“页面回显数据”作为「误报告警」判断的条件之一。







 **应急响应要干什么啊**
应急响应通常包括以下步骤：
确认安全事件：要及时发现安全事件，快速确认其类型、范围和危害程度，并进行预警和通报。
切断攻击链：要采取有效措施，尽可能快地切断攻击链，阻止攻击扩散和进一步损失。
收集证据：要收集、保留安全事件相关的证据和信息，以便后续的调查和追踪。
分析病毒特征：要对病毒、木马等安全事件的特征进行分析，找出其入侵方式、攻击目的、传播途径等信息，以便防止类似安全事件的再次发生。
应对措施：根据安全事件的类型和程度，采取相应的应对措施，如修补漏洞、清除恶意软件、升级补丁、修改配置等。
恢复业务：在限制损失和消除安全风险的基础上，尽快恢复业务，保障用户和业务的正常运转。
事件总结：要对安全事件的应急响应过程进行总结和反思，发现问题并进行改进，提高应急响应能力。
常见的应急响应事件分类：web入侵：网页挂马、主页篡改、Webshell 系统入侵：病毒木马、勒索软件、远控后门 网络攻击：DDOS攻击、DNS劫持、ARP欺骗 网站被挂马如何应急（具体流程都是差不多的，看着变）
1.取证，登录服务器，备份，检查服务器敏感目录，查毒（搜索后门文件-注意文件的时间， 用户，后缀等属性），调取日志（系统，中间件日志，WAF日志等）；
2.处理，恢复备份（快照回滚最近一次），确定入侵方法（漏洞检测并进行修复）
3.溯源，查入侵IP，入侵手法（网路攻击事件）的确定等
4.记录，归档--------预防-事件检测-抑制-根除-恢复-跟踪-记录通用漏洞的应对等其他 安全应急事件

 判断威胁情报是否有误，就看wireshark，进行流量分析判断是否为正常业务操作





### 是否了解水坑攻击

是一种网络攻击方式。攻击者通过在特定网页中植入恶意代码，来攻击访问该网页的用户。  存储型xss攻击
防御：安装可以信赖的安全软件，监测所有网络传输流量，及时发现异常通信





### XXE（XML External Entity

是指xml外部实体攻击漏洞。XML外部实体攻击是针对解析XML输入的应用程序的一种攻击。当包含对外部实体的引用的XML输入被弱配置XML解析器处理时，就会发生这种攻击。这种攻击通过构造恶意内容，可导致读取任意文件、执行系统命令、探测内网端口、攻击内网网站等危害。

方法：直接通过DTD外部实体声明

防御：

1、配置XML处理器去使用本地静态的DTD，不允许XML中含有任何自己声明的DTD；

2、过滤用户提交的XML数据；过滤关键词：<!DOCTYPE和<!ENTITY，或者SYSTEM和PUBLIC；

3、使用开发语言提供的禁用外部实体的方法；





### 破壳漏洞

该漏洞可以通过构造环境变量的值来执行想要执行的攻击代码脚本，漏洞会影响到与Bash交互的多种应用

漏洞原理：导致漏洞出问题是以“(){”开头定义的环境变量在命令ENV中解析成函数后，Bash执行并未退出，而是继续解析并执行shell命令。而其核心的原因在于在输入的过滤中没有严格限制边界，也没有做出合法化的参数判断。 

影响范围：确认该漏洞会影响目前主流的Linux和Mac OSX操作系统平台，包括但不限于Redhat、CentOS、Ubuntu、Debian、Fedora、Amazon Linux、OS X 10.10****

### 如何是判断钓鱼邮件

消息中要求提供个人信息，消息中包含错误的拼写或者语法，邮件消息似乎来自于政府机构
信息中包含一个不匹配的网址，网址中包含误导域名

蓝队思路：对邮件内部的链接进行whois查询，天眼ioc，附件在沙盒进行分析



53.如何判断文件上传是否成功
如果有返回路径，访问上传到的路径

查看返回数据包是不是200

查看是否有增加文件





### ⭐XSS的原理和类型？绕过方法？

XSS（跨站脚本攻击）是一种常见的Web应用程序攻击，攻击者通过在Web页面中注入恶意脚本，来窃取用户的敏感信息或执行非法操作。下面是XSS的原理、类型以及绕过方法：

原理：XSS攻击的原理是利用Web应用程序对用户输入的信任，将恶意脚本嵌入到Web页面中。当用户访问包含恶意脚本的页面时，恶意脚本将会执行，从而实现攻击者的目的。

主要类型：XSS攻击可以分为以下三种类型：

- 存储型XSS攻击：攻击者将恶意脚本存储到Web应用程序的数据库中，当其他用户访问包含恶意脚本的页面时，恶意脚本将会执行。
- 反射型XSS攻击：攻击者将恶意脚本作为参数发送给Web应用程序，Web应用程序将恶意脚本反射到响应页面中，当用户访问包含恶意脚本的页面时，恶意脚本将会执行。
- DOM型XSS攻击：攻击者将恶意脚本嵌入到Web页面中，当用户访问包含恶意脚本的页面时，恶意脚本将会修改页面的DOM结构，从而实现攻击者的目的。

绕过方法：为了绕过XSS防御措施，攻击者可以采用以下方法：

- 编码：攻击者可以使用HTML编码或URL编码来绕过对输入内容的过滤和验证。例如，攻击者可以使用`<script>`标签的HTML编码`<script>`来绕过过滤。

- 混淆：攻击者可以利用Unicode字符集中的字符、HTML标签属性、JavaScript语法等方法来混淆恶意脚本，从而绕过过滤和验证。
- 利用事件：攻击者可以在Web页面中注入恶意脚本，并利用事件触发器（如onclick、onload等）来触发恶意脚本执行。
- 双写绕过、大小写转换、引号使用、用 / 代替空格。





### Windows操作系统的日志文件路径：

- 应用程序日志文件：C:\Windows\System32\winevt\Logs
- 系统日志文件：C:\Windows\System32\winevt\Logs
- 安全日志文件：C:\Windows\System32\winevt\Logs
- IIS日志文件：C:\inetpub\logs\LogFiles
- Exchange日志文件：C:\Program Files\Microsoft\Exchange Server\V15\Logging

### Linux操作系统的日志文件路径：

- 系统日志文件：/var/log/syslog或/var/log/messages
- 安全日志文件：/var/log/secure或/var/log/auth.log
- 应用程序日志文件：/var/log/application_name.log（具体日志文件路径取决于应用程序的名称和配置）
- Apache日志文件：/var/log/apache2/access.log或/var/log/httpd/access_log
- MySQL日志文件：/var/log/mysql/error.log
- 不同的Linux发行版可能会有不同的日志文件名称和位置，例如Ubuntu和Debian使用的是syslog，而CentOS和Red Hat Enterprise Linux使用的是rsyslog。
- /var/log/cron 与定时任务相关的日志信息
- cat /etc/anacrontab     查看anacron异步定时任务

#### ⭐webshell流量特征？

**菜刀：**

伪造 X-Forwarded-For头，每次利用X-Forwarded-For头都会不同

执行了 base64_decode 函数对 z0 进行 base64 后，经过 eval 函数执行命令

QGluaV9

@ini_set("display_errors"

**c刀：** 

c刀是由java写的客户端，所以它的适用性比较强，linux、windows平台都可以用，cknife首先会查询服务器版本信息，接下来才是查询当前目录。由于cknife是基于菜刀改的，在流量上与菜刀是十分相似的

**蚁剑：**

如果用默认的蚁剑测试，连接时会请求两次

其请求体只是经过 url 编码

@ini_set("display_errors"

在执行命令，文件操作等地方会有0x开头的参数

**冰蝎：**

消息体内容采用 AES 加密

流量会以时间的方式生成长度 16 的随机 key

中间结果字符串 assert|eval("phpinfo();") 此数据由冰蝎加载器发出的，已经定义好的

冰蝎3.0内置的默认内置16个ua（user-agent）头
**哥斯拉**：

Cookie 后带有分号  响应包的结构体征为：md5前十六位+base64+md5后十六位。
请求1：发送一段固定代码（payload），返回内容为空；
请求2：发送一段固定代码（test），返回内容为固定字符串，如下





### fastjson利用原理、利用链

支持将Java Bean序列化为JSON字符串，也可以从JSON字符串反序列化到JavaBean

Fastjson存在远程代码执行漏洞，autotype开关的限制可以被绕过，链式的反序列化攻击者精心构造反序列化利用链，最终达成远程命令执行的后果。此漏洞本身无法绕过Fastjson的黑名单限制，需要配合不在黑名单中的反序列化利用链才能完成完整的漏洞利用





### 51.常见中间件漏洞

IIS 6.0
/xx.asp/xx.jpg "xx.asp" 是⽂件夹名
IIS 7.0/7.5
默认 Fast-CGI 开启，直接在 url 中图⽚地址后⾯输⼊ / 1.php，会把正常图⽚当成 php 解析
Nginx
版本⼩于等于 0.8.37，利⽤⽅法和 IIS 7.0/7.5 ⼀样，Fast-CGI 关闭情况下也可利⽤。
空字节代码 xxx.jpg%00.php
Apache
上传的⽂件命名为：test.php.x1.x2.x3，Apache 是从右往左判断后缀





### 永恒之蓝smb

永恒之蓝是在Windows的SMB服务处理SMB v1请求时发生的漏洞，这个漏洞导致攻击者在目标系统上可以执行任意代码。通过永恒之蓝漏洞会扫描开放445文件共享端口的Windows机器，无需用户任何操作，只要开机上网，不法分子就能在电脑和服务器中植入勒索软件、远程控制木马、虚拟货币挖矿机等恶意程序。



#### 挖矿病毒处置流程

- **事件分析**
- 一般来说会有一些进程占用率高
- 查看文件的创建时间为2022.03.26
- 位到对应的目录，确定主机中了挖矿病毒，且发现域名
- 微步在线查询可分析为IP为矿池
- **清除痕迹**

查看病毒是否写写入了计时任务，控制面板-管理工具-任务计划程序

分析任务名、运行时间、触发器和位置是否是恶意创建的

分析有无异常的外连地址和端口情况 netstat -an

- **清除SSH公钥**
- 查看进程详细信息       ps -ef | grep 23280

查看文件的详细信息，创建时间     ls -l |grep -e cpunp -e dof

 kill -9 $PID                      rm -rf 文件名